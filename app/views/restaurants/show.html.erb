<style>
  .header {
    background-image: url("<%= @restaurant.photo %>");
  }
</style>


<div class="header">
  <h1><%= @restaurant.name %></h1>
</div>

<div class="notice">
  <%= flash[:notice] if flash[:notice] %>
</div>

<h3>
<%= link_to "Search Again", root_path%>
</h3>

<div class="socials">
  <% socials = {phone: @restaurant.phone, facebook: @restaurant.facebook, twitter: @restaurant.twitter, globe: @restaurant.url}.compact %>
  <% socials.each do |k, v| %>
  <a href="
    <% case k %>
    <% when :phone %>
    <%= "tel:#{v.tr('^0-9','')}" %>
    <% when :facebook %>
    <%= "https://facebook.com/#{v}" %>
    <% when :twitter %>
    <%= "https://twitter.com/#{v}" %>
    <% when :globe %>
    <%= v %>
    <% end %>
  ">
    <i class="fa fa-<%= k.to_s %> fa-lg"></i>
  </a>
  <% end %>
</div>

<% if @user && !@user_review %>
  <%= link_to 'Create a new review', new_review_path(@restaurant.id) %>
<% end %>

<% unless @reviews.empty? %>

  <h3 id="review_list_header">Review List</h3>

  <% if @user && @user_review %>
      <h4 id="review_list_header">Your Review, <%= link_to @user.name, @user %></h4>
        <%= button_to 'Edit your review', edit_review_path(@user_review.id), method: 'get' %>

    <div class="review">
      <div class="user-info">
        <%= link_to @user.name, @user %> said:
      </div>

      <section class="review-content">
          <section class="review-title">
            <%= @user_review.title %>
          </section>
          <section class="ratings">
            <% @user_review.ratings_hash.each do |k, v| %>
              <div class='<%= k.downcase %>-rating'>
              <% v.times do |n| %>
                <i class="fa fa-star"></i>
              <% end %>
              <% (5-v).times do |n| %>
                <i class="fa fa-star-o"></i>
              <% end %>
              <%= k %>
            </div>
            <% end %>
          </section>
        <section class="review-text">
            <%= @user_review.content %>
        </section>
        </section>
      </div>
      <br>
  <% end %>

  <% @reviews.each do |review| %>
  <% unless review.user.id == @user.id %>
    <div class="review">
      <div class="user-info">
        <%= link_to review.user.name, user_path(review.user) %> said:

      </div>
      <section class="review-content">
          <section class="review-title">
            <%= review.title %>
          </section>
          <section class="ratings">
            <% review.ratings_hash.each do |k, v| %>
              <div class='<%= k.downcase %>-rating'>
              <% v.times do |n| %>
                <i class="fa fa-star"></i>
              <% end %>
              <%= k %>
            </div>
            <% end %>
          </section>
          <section class="review-text">
            <%= review.content %>
        </section>
        </section>
      </div>
    <% end %>
    <br>
  <% end %>
<% end %>
